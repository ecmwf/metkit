<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: encoder_overall_structure Pages: 1 -->
<svg width="922pt" height="1268pt"
 viewBox="0.00 0.00 922.00 1268.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1264)">
<title>encoder_overall_structure</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1264 918,-1264 918,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_inputs</title>
<path fill="none" stroke="#000000" d="M50,-1181C50,-1181 894,-1181 894,-1181 900,-1181 906,-1187 906,-1193 906,-1193 906,-1240 906,-1240 906,-1246 900,-1252 894,-1252 894,-1252 50,-1252 50,-1252 44,-1252 38,-1246 38,-1240 38,-1240 38,-1193 38,-1193 38,-1187 44,-1181 50,-1181"/>
<text text-anchor="middle" x="472" y="-1240" font-family="Times,serif" font-size="10.00" fill="#000000">Inputs</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_frontend</title>
<path fill="none" stroke="#000000" d="M20,-800C20,-800 220,-800 220,-800 226,-800 232,-806 232,-812 232,-812 232,-1103 232,-1103 232,-1109 226,-1115 220,-1115 220,-1115 20,-1115 20,-1115 14,-1115 8,-1109 8,-1103 8,-1103 8,-812 8,-812 8,-806 14,-800 20,-800"/>
<text text-anchor="middle" x="120" y="-1103" font-family="Times,serif" font-size="10.00" fill="#000000">frontend/ (pure functions)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_backend</title>
<path fill="none" stroke="#000000" d="M300,-404C300,-404 444,-404 444,-404 450,-404 456,-410 456,-416 456,-416 456,-722 456,-722 456,-728 450,-734 444,-734 444,-734 300,-734 300,-734 294,-734 288,-728 288,-722 288,-722 288,-416 288,-416 288,-410 294,-404 300,-404"/>
<text text-anchor="middle" x="372" y="-722" font-family="Times,serif" font-size="10.00" fill="#000000">backend/ (header construction)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_api</title>
<path fill="none" stroke="#000000" d="M466,-8C466,-8 614,-8 614,-8 620,-8 626,-14 626,-20 626,-20 626,-326 626,-326 626,-332 620,-338 614,-338 614,-338 466,-338 466,-338 460,-338 454,-332 454,-326 454,-326 454,-20 454,-20 454,-14 460,-8 466,-8"/>
<text text-anchor="middle" x="540" y="-326" font-family="Times,serif" font-size="10.00" fill="#000000">api/ (orchestration)</text>
</g>
<!-- mars -->
<g id="node1" class="node">
<title>mars</title>
<ellipse fill="none" stroke="#000000" cx="120" cy="-1207" rx="74.187" ry="18"/>
<text text-anchor="middle" x="120" y="-1203.3" font-family="Times,serif" font-size="14.00" fill="#000000">MARS dictionary</text>
</g>
<!-- frontend -->
<g id="node5" class="node">
<title>frontend</title>
<polygon fill="none" stroke="#000000" points="220,-1088 20,-1088 20,-1050 220,-1050 220,-1088"/>
<text text-anchor="middle" x="120" y="-1072.8" font-family="Times,serif" font-size="14.00" fill="#000000">Frontend</text>
<text text-anchor="middle" x="120" y="-1057.8" font-family="Times,serif" font-size="14.00" fill="#000000">(derive EncoderCfg from MARS)</text>
</g>
<!-- mars&#45;&gt;frontend -->
<g id="edge1" class="edge">
<title>mars&#45;&gt;frontend</title>
<path fill="none" stroke="#000000" d="M120,-1188.9589C120,-1165.9976 120,-1126.0259 120,-1098.5784"/>
<polygon fill="#000000" stroke="#000000" points="123.5001,-1098.3791 120,-1088.3791 116.5001,-1098.3791 123.5001,-1098.3791"/>
<text text-anchor="middle" x="134" y="-1134.8" font-family="Times,serif" font-size="14.00" fill="#000000">input</text>
</g>
<!-- raii -->
<g id="node7" class="node">
<title>raii</title>
<polygon fill="none" stroke="#000000" points="447.5,-707 296.5,-707 296.5,-654 447.5,-654 447.5,-707"/>
<text text-anchor="middle" x="372" y="-691.8" font-family="Times,serif" font-size="14.00" fill="#000000">RAII Encoder</text>
<text text-anchor="middle" x="372" y="-676.8" font-family="Times,serif" font-size="14.00" fill="#000000">(uses cfg + dictionaries)</text>
<text text-anchor="middle" x="372" y="-661.8" font-family="Times,serif" font-size="14.00" fill="#000000">(build consistent header)</text>
</g>
<!-- mars&#45;&gt;raii -->
<g id="edge7" class="edge">
<title>mars&#45;&gt;raii</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.1229,-1194.568C233.3537,-1177.3778 320,-1140.0829 320,-1069 320,-1069 320,-1069 320,-834.5 320,-792.1757 337.8491,-746.5843 352.6325,-716.082"/>
<polygon fill="#000000" stroke="#000000" points="355.7707,-717.6317 357.0989,-707.1205 349.5057,-714.5092 355.7707,-717.6317"/>
<text text-anchor="middle" x="329.5" y="-951.8" font-family="Times,serif" font-size="14.00" fill="#000000">use</text>
</g>
<!-- par -->
<g id="node2" class="node">
<title>par</title>
<ellipse fill="none" stroke="#000000" cx="368" cy="-1207" rx="130.777" ry="18"/>
<text text-anchor="middle" x="368" y="-1203.3" font-family="Times,serif" font-size="14.00" fill="#000000">PAR / MISC / EXTRA dictionary</text>
</g>
<!-- par&#45;&gt;raii -->
<g id="edge8" class="edge">
<title>par&#45;&gt;raii</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M380.9342,-1188.7935C397.7516,-1163.2872 425,-1114.8812 425,-1069 425,-1069 425,-1069 425,-834.5 425,-792.0917 406.8077,-746.5147 391.74,-716.0387"/>
<polygon fill="#000000" stroke="#000000" points="394.84,-714.4132 387.1877,-707.0857 388.6002,-717.5859 394.84,-714.4132"/>
<text text-anchor="middle" x="434.5" y="-951.8" font-family="Times,serif" font-size="14.00" fill="#000000">use</text>
</g>
<!-- opt -->
<g id="node3" class="node">
<title>opt</title>
<ellipse fill="none" stroke="#000000" cx="612" cy="-1207" rx="70.6878" ry="18"/>
<text text-anchor="middle" x="612" y="-1203.3" font-family="Times,serif" font-size="14.00" fill="#000000">OPT dictionaries</text>
</g>
<!-- opt&#45;&gt;raii -->
<g id="edge9" class="edge">
<title>opt&#45;&gt;raii</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M602.9008,-1188.7634C590.8218,-1162.8274 571,-1113.4882 571,-1069 571,-1069 571,-1069 571,-834.5 571,-773.0715 510.9604,-732.6628 456.8381,-708.716"/>
<polygon fill="#000000" stroke="#000000" points="458.0875,-705.4436 447.5171,-704.7243 455.3318,-711.8784 458.0875,-705.4436"/>
<text text-anchor="middle" x="580.5" y="-951.8" font-family="Times,serif" font-size="14.00" fill="#000000">use</text>
</g>
<!-- vals -->
<g id="node4" class="node">
<title>vals</title>
<ellipse fill="none" stroke="#000000" cx="812" cy="-1207" rx="86.3847" ry="18"/>
<text text-anchor="middle" x="812" y="-1203.3" font-family="Times,serif" font-size="14.00" fill="#000000">Values (data payload)</text>
</g>
<!-- api -->
<g id="node9" class="node">
<title>api</title>
<polygon fill="none" stroke="#000000" points="617.5,-311 462.5,-311 462.5,-243 617.5,-243 617.5,-311"/>
<text text-anchor="middle" x="540" y="-295.8" font-family="Times,serif" font-size="14.00" fill="#000000">API</text>
<text text-anchor="middle" x="540" y="-280.8" font-family="Times,serif" font-size="14.00" fill="#000000">(call frontend + backend,</text>
<text text-anchor="middle" x="540" y="-265.8" font-family="Times,serif" font-size="14.00" fill="#000000">then encode values,</text>
<text text-anchor="middle" x="540" y="-250.8" font-family="Times,serif" font-size="14.00" fill="#000000">return GRIB message)</text>
</g>
<!-- vals&#45;&gt;api -->
<g id="edge10" class="edge">
<title>vals&#45;&gt;api</title>
<path fill="none" stroke="#000000" d="M799.0658,-1188.7935C782.2484,-1163.2872 755,-1114.8812 755,-1069 755,-1069 755,-1069 755,-438.5 755,-371.1437 686.7067,-328.4118 627.1001,-303.9431"/>
<polygon fill="#000000" stroke="#000000" points="628.2055,-300.6161 617.6199,-300.1718 625.618,-307.1203 628.2055,-300.6161"/>
<text text-anchor="middle" x="769" y="-753.8" font-family="Times,serif" font-size="14.00" fill="#000000">input</text>
</g>
<!-- encfg -->
<g id="node6" class="node">
<title>encfg</title>
<polygon fill="none" stroke="#000000" points="224,-861 16,-861 16,-808 224,-808 224,-861"/>
<text text-anchor="middle" x="120" y="-845.8" font-family="Times,serif" font-size="14.00" fill="#000000">EncoderCfg</text>
<text text-anchor="middle" x="120" y="-830.8" font-family="Times,serif" font-size="14.00" fill="#000000">(sections + ordered concepts)</text>
<text text-anchor="middle" x="120" y="-815.8" font-family="Times,serif" font-size="14.00" fill="#000000">(used once; stored const for debug)</text>
</g>
<!-- frontend&#45;&gt;encfg -->
<g id="edge2" class="edge">
<title>frontend&#45;&gt;encfg</title>
<path fill="none" stroke="#000000" d="M120,-1049.8099C120,-1010.7994 120,-921.6703 120,-871.1698"/>
<polygon fill="#000000" stroke="#000000" points="123.5001,-871.0117 120,-861.0118 116.5001,-871.0118 123.5001,-871.0117"/>
<text text-anchor="middle" x="143" y="-951.8" font-family="Times,serif" font-size="14.00" fill="#000000">generate</text>
</g>
<!-- encfg&#45;&gt;raii -->
<g id="edge3" class="edge">
<title>encfg&#45;&gt;raii</title>
<path fill="none" stroke="#000000" d="M94.645,-807.8696C80.9715,-790.2212 69.4202,-767.2327 83,-750 107.989,-718.2891 210.4006,-699.3782 286.2531,-689.467"/>
<polygon fill="#000000" stroke="#000000" points="286.8229,-692.9228 296.2999,-688.1861 285.9375,-685.979 286.8229,-692.9228"/>
<text text-anchor="middle" x="111" y="-753.8" font-family="Times,serif" font-size="14.00" fill="#000000">instantiate</text>
</g>
<!-- encfg&#45;&gt;raii -->
<g id="edge11" class="edge">
<title>encfg&#45;&gt;raii</title>
<path fill="none" stroke="#000000" stroke-dasharray="1,5" d="M135.7561,-807.6842C147.7669,-789.2636 165.8191,-765.4395 187,-750 219.4389,-726.3542 260.869,-709.8051 296.296,-698.805"/>
<text text-anchor="middle" x="237.5" y="-753.8" font-family="Times,serif" font-size="14.00" fill="#000000">(cacheable design)</text>
</g>
<!-- gribHeader -->
<g id="node8" class="node">
<title>gribHeader</title>
<polygon fill="none" stroke="#000000" points="444.5,-465 307.5,-465 307.5,-412 444.5,-412 444.5,-465"/>
<text text-anchor="middle" x="376" y="-449.8" font-family="Times,serif" font-size="14.00" fill="#000000">Grib Header</text>
<text text-anchor="middle" x="376" y="-434.8" font-family="Times,serif" font-size="14.00" fill="#000000">(valid GRIB message)</text>
<text text-anchor="middle" x="376" y="-419.8" font-family="Times,serif" font-size="14.00" fill="#000000">(values = 0)</text>
</g>
<!-- raii&#45;&gt;gribHeader -->
<g id="edge4" class="edge">
<title>raii&#45;&gt;gribHeader</title>
<path fill="none" stroke="#000000" d="M372.4434,-653.6771C373.1616,-610.225 374.5807,-524.3682 375.3924,-475.2595"/>
<polygon fill="#000000" stroke="#000000" points="378.8949,-475.1307 375.5608,-465.0742 371.8959,-475.0149 378.8949,-475.1307"/>
<text text-anchor="middle" x="396" y="-555.8" font-family="Times,serif" font-size="14.00" fill="#000000">produce</text>
</g>
<!-- gribHeader&#45;&gt;api -->
<g id="edge5" class="edge">
<title>gribHeader&#45;&gt;api</title>
<path fill="none" stroke="#000000" d="M403.0813,-411.8316C428.9133,-386.3933 468.2026,-347.703 498.0788,-318.2821"/>
<polygon fill="#000000" stroke="#000000" points="500.7884,-320.5261 505.4577,-311.0157 495.8767,-315.5385 500.7884,-320.5261"/>
<text text-anchor="middle" x="537.5" y="-357.8" font-family="Times,serif" font-size="14.00" fill="#000000">encode values on grib header</text>
</g>
<!-- outmsg -->
<g id="node10" class="node">
<title>outmsg</title>
<polygon fill="none" stroke="#000000" points="610.5,-54 469.5,-54 469.5,-16 610.5,-16 610.5,-54"/>
<text text-anchor="middle" x="540" y="-38.8" font-family="Times,serif" font-size="14.00" fill="#000000">GRIB message</text>
<text text-anchor="middle" x="540" y="-23.8" font-family="Times,serif" font-size="14.00" fill="#000000">(valid header + values)</text>
</g>
<!-- api&#45;&gt;outmsg -->
<g id="edge6" class="edge">
<title>api&#45;&gt;outmsg</title>
<path fill="none" stroke="#000000" d="M540,-242.8406C540,-195.1765 540,-109.515 540,-64.4907"/>
<polygon fill="#000000" stroke="#000000" points="543.5001,-64.2264 540,-54.2265 536.5001,-64.2265 543.5001,-64.2264"/>
<text text-anchor="middle" x="556.5" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#000000">return</text>
</g>
</g>
</svg>
